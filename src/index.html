<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fast Tasks</title>
<script>
// Disable fetching of deps.js. This is temporary until we generate
// a proper deps.js file. When we do so, we should also remove the
// modification in base.js that returns early in goog.require().
CLOSURE_NO_DEPS = true;
</script>
<script src="js/closure/base.js"></script>
<script src="js/dto/tasks.js"></script>
<script src="js/dto/task.js"></script>
<script src="js/settings.js"></script>
<script src="js/urlutil.js"></script>
<script src="js/auth.js"></script>
<script src="js/xhr.js"></script>
<script src="js/taskapi.js"></script>
<script src="js/application.js"></script>
<script>
function onError(authParams, err) {
  if (err instanceof ft.taskapi.Error) {
    // We have a taskapi Error, so we can inspect its additional
    // properties, such as 'code', to learn more about the error.
    if (err.code === 401) {
      // Error code 401 indicates an auth failure, so attempt to reauthenticate.
      ft.auth.redirectToAuthUrl(authParams);
    }
  }
}

(function() {
  var authParams = ft.auth.getCurrentAuthParams();
  ft.auth.clearAuthInfoInUrl();
  if (authParams.getError()) {
    if (authParams.getError() === 'access_denied') {
      console.log('User did not grant needed permissions.');
    } else {
      console.log('Unknown auth error: ' + authParams.getError());
    }
    return;
  }
  if (!authParams.getAccessToken()) {
    // No auth token available, so redirect to the auth handler
    // to get a valid access token.
    ft.auth.redirectToAuthUrl(authParams);
    return;
  }

  var app = new ft.Application();
  app.start(authParams.getAccessToken())
      .catch(goog.partial(onError, authParams));
}());
</script>
</head>
<body>
Nothing to see here just yet...
</body>
</html>
